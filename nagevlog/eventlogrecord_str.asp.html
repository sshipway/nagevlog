<html><head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    	<!--- TOOLBAR_EXEMPT --->
<link rel="stylesheet" type="text/css" href="eventlogrecord_str.asp_files/n6.css">
<link rel="stylesheet" type="text/css" href="eventlogrecord_str.asp_files/down.css">

<style type="text/css"><!--

	PRE.clsCode { font-size:110%; } 

	PRE.clsSyntax { font-size:100%; }  

--></style>

	<style>
	BODY
	{
		font-family:verdana,arial,helvetica;
		margin:0;
	}
	</style>
	
<script language="javascript" src="eventlogrecord_str.asp_files/toolbar.js"></script>

<link rel="stylesheet" type="text/css" href="eventlogrecord_str.asp_files/default.css">


   <script language="JavaScript"><!--
   function BrowserData()
{
		this.userAgent = "Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.0rc2) Gecko/20020510";

		this.bot = false;

		this.browser = "Nav";

		this.majorVer = 5;

		this.minorVer = "0";

		this.platform = "X11";

		this.getsNavBar = false;

		this.doesActiveX = false;

		this.doesPersistence = false;

		this.fullVer = 5;

   }

   var oBD = new BrowserData();

   //--></script>

   <script language="JavaScript"><!--

   if (document.layers) {
    origWidth  = innerWidth;
  origHeight = innerHeight;
   }

   function resizeFix() { if (innerWidth != origWidth || innerHeight != origHeight) location.reload(); }

   if (document.layers) onresize = resizeFix;

   //--></script>

   <script language="JavaScript"><!--
   function BrowserData()
{
		this.userAgent = "Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.0rc2) Gecko/20020510";

		this.bot = false;

		this.browser = "Nav";

		this.majorVer = 5;

		this.minorVer = "0";

		this.platform = "X11";

		this.getsNavBar = false;

		this.doesActiveX = false;

		this.doesPersistence = false;

		this.fullVer = 5;

   }

   var oBD = new BrowserData();

   //--></script>

   <script language="JavaScript"><!--

   if (document.layers) {
    origWidth  = innerWidth;
  origHeight = innerHeight;
   }

   function resizeFix() { if (innerWidth != origWidth || innerHeight != origHeight) location.reload(); }

   if (document.layers) onresize = resizeFix;

   //--></script>

<script>
	if( self == top )
{
	location = "/library/en-us/debug/base/eventlogrecord_str.asp";
}

</script></head>
<body topmargin="0" leftmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff" text="#000000"><xml id="xmlPageContext"><eyebrow findmenu="false">
	<item label="MSDN Home" url="/default.asp">
	<item label="MSDN Library" url="/library/default.asp">
	<item label="Windows Development" id="msdnlib1466" xmlsrc="/library/en-us/toc/msdnlib/msdnlib1466_.xml"><item label="Windows Base Services" id="msdnlib1530" xmlsrc="/library/en-us/toc/msdnlib/msdnlib1530_.xml"><item label="Debugging and Error Handling" id="msdnlib1531" xmlsrc="/library/en-us/toc/msdnlib/msdnlib1531_.xml"><item label="SDK Documentation" url="/library/en-us/debug/base/debugging_and_error_handling.asp" id="msdnlib1532"><item label="Event Logging" url="/library/en-us/debug/base/event_logging.asp" id="debug247" xmlsrc="/library/en-us/toc/debug/debug247_.xml"><item label="Event Logging Reference" url="/library/en-us/debug/base/event_logging_reference.asp" id="debug272" xmlsrc="/library/en-us/toc/debug/debug272_.xml"><item label="Event Logging Structures" url="/library/en-us/debug/base/event_logging_structures.asp" id="debug287"><item label="EVENTLOGRECORD" url="/library/en-us/debug/base/eventlogrecord_str.asp" id="debug289"></item></item> 

       </item></item></item></item></item></item></item></item></eyebrow></xml><table border="0" cellspacing="0" cellpadding="4" height="24" width="100%" bgcolor="#ffffff">
       <tbody><tr>
        <td class="eyebrow" valign="middle" align="left" width="100%">  

            <a class="small" target="_top" href="http://msdn.microsoft.com/default.asp">MSDN Home</a> &gt; 
            <a class="small" target="_top" href="http://msdn.microsoft.com/library/default.asp">MSDN Library</a> &gt; 
            <a class="small" target="_top" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/debug/base/debugging_and_error_handling.asp">SDK Documentation</a> &gt; 
            <a class="small" target="_top" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/debug/base/event_logging.asp">Event Logging</a> &gt; 
            <a class="small" target="_top" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/debug/base/event_logging_reference.asp">Event Logging Reference</a> &gt; 
            <a class="small" target="_top" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/debug/base/event_logging_structures.asp">Event Logging Structures</a><a href=""></a>
        </td>
       </tr>
       </tbody></table>
 <table class="clsContainer" cellpadding="15" cellspacing="0" float="left" width="100%" border="0"> <tbody><tr> <td valign="top">
<!--TOOLBAR_START-->
<!--TOOLBAR_EXEMPT-->
<!--TOOLBAR_END-->
<!-- Begin Content -->

<table class="buttonbarshade" cellspacing="0"><tbody><tr><td> </td></tr></tbody></table>
<table class="buttonbartable" cellspacing="0">
<tbody><tr id="hdr"><td class="runninghead" nowrap="">Platform SDK: Debugging and Error Handling</td></tr>
</tbody></table>

<h1><a name="base.eventlogrecord_str"></a>EVENTLOGRECORD</h1>
<p></p><p>The 
<a><b>EVENTLOGRECORD</b></a> structure contains information about an event record returned by the 
<a href="http://msdn.microsoft.com/library/en-us/debug/base/readeventlog.asp"><b>ReadEventLog</b></a> function.</p>
<p></p>
<pre class="syntax" xml:space="preserve">typedef struct _EVENTLOGRECORD {<br>  DWORD Length;<br>  DWORD Reserved;<br>  DWORD RecordNumber;<br>  DWORD TimeGenerated;<br>  DWORD TimeWritten;<br>  DWORD EventID;<br>  WORD EventType;<br>  WORD NumStrings;<br>  WORD EventCategory;<br>  WORD ReservedFlags;<br>  DWORD ClosingRecordNumber;<br>  DWORD StringOffset;<br>  DWORD UserSidLength;<br>  DWORD UserSidOffset;<br>  DWORD DataLength;<br>  DWORD DataOffset;
} EVENTLOGRECORD, *PEVENTLOGRECORD;</pre>
<h4>Members</h4>
<dl><dt><b>Length</b></dt><dd>Size of this event record, in bytes. Note that
this value is stored at both ends of the entry to ease moving forward or
backward through the log. The length includes any pad bytes inserted at the
end of the record for <b>DWORD</b> alignment.</dd><dt><b>Reserved</b></dt><dd>Reserved.</dd><dt><b>RecordNumber</b></dt><dd>Record number of the record. This value can be used with the EVENTLOG_SEEK_READ flag in the 
<a href="http://msdn.microsoft.com/library/en-us/debug/base/readeventlog.asp"><b>ReadEventLog</b></a> function to begin reading at a specified record. For more information, see 
<a href="http://msdn.microsoft.com/library/en-us/debug/base/event_log_records.asp">Event Log Records</a>.</dd><dt><b>TimeGenerated</b></dt><dd>Time
at which this entry was submitted. This time is measured in the number of
seconds elapsed since 00:00:00 January 1, 1970, Universal Coordinated Time.</dd><dt><b>TimeWritten</b></dt><dd>Time
at which this entry was received by the service to be written to the logfile.
This time is measured in the number of seconds elapsed since 00:00:00 January
1, 1970, Universal Coordinated Time.</dd><dt><b>EventID</b></dt><dd>Event identifier. The value is specific to the event source for the event, and is used with <b>SourceName</b> to locate a description string in the message file for the event source. For more information, see 
<a href="http://msdn.microsoft.com/library/en-us/debug/base/event_identifiers.asp">Event Identifiers</a>.</dd><dt><b>EventType</b></dt><dd>Type of event. This member can be one of the following values. 

<p></p>
<table>
<tbody><tr>
<th>Value</th>
<th>Meaning</th>
</tr>
<tr>
<td width="40%">EVENTLOG_ERROR_TYPE</td>
<td width="60%">Error event</td>
</tr>
<tr>
<td width="40%">EVENTLOG_WARNING_TYPE</td>
<td width="60%">Warning event</td>
</tr>
<tr>
<td width="40%">EVENTLOG_INFORMATION_TYPE</td>
<td width="60%">Information event</td>
</tr>
<tr>
<td width="40%">EVENTLOG_AUDIT_SUCCESS</td>
<td width="60%">Success Audit event</td>
</tr>
<tr>
<td width="40%">EVENTLOG_AUDIT_FAILURE</td>
<td width="60%">Failure Audit event</td>
</tr>
</tbody></table>
<p><br></p><p>For more information, see 
<a href="http://msdn.microsoft.com/library/en-us/debug/base/event_types.asp">Event Types</a>.</p>
<p></p></dd><dt><b>NumStrings</b></dt><dd>Number of strings present in the log (at the position indicated by <b>StringOffset</b>). These strings are merged into the message before it is displayed to the user.</dd><dt><b>EventCategory</b></dt><dd>Category for this event. The meaning of this value depends on the event source. For more information, see 
<a href="http://msdn.microsoft.com/library/en-us/debug/base/event_categories.asp">Event Categories</a>.</dd><dt><b>ReservedFlags</b></dt><dd>Reserved.</dd><dt><b>ClosingRecordNumber</b></dt><dd>Reserved.</dd><dt><b>StringOffset</b></dt><dd>Offset of the description strings within this event log record.</dd><dt><b>UserSidLength</b></dt><dd>Size of the <b>UserSid</b> member, in bytes. This value can be zero if no security identifier was provided.</dd><dt><b>UserSidOffset</b></dt><dd>Offset of the security identifier (SID) within this event log record. To obtain the user name for this SID, use the 
<a href="http://msdn.microsoft.com/library/en-us/security/security/lookupaccountsid.asp"><b>LookupAccountSid</b></a> function.</dd><dt><b>DataLength</b></dt><dd>Size of the event-specific data (at the position indicated by <b>DataOffset</b>), in bytes.</dd><dt><b>DataOffset</b></dt><dd>Offset
of the event-specific information within this event log record, in bytes.
This information could be something specific (a disk driver might log the
number of retries, for example), followed by binary information specific
to the event being logged and to the source that generated the entry.</dd></dl>
<h4>Remarks</h4>
<p>The defined members are followed by the replacement strings for the message
identified by the event identifier, the binary information, some pad bytes
to make sure the full entry is on a <b>DWORD</b> boundary, and finally the
length of the log entry again. Because the strings and the binary information
can be of any length, no structure members are defined to reference them.</p>
<p>The event identifier together with <b>SourceName</b> and a language identifier
identify a string that describes the event in more detail. The strings are
used as replacement strings and are merged into the message string to make
a complete message. The message strings are contained in a message file specified
in the source entry in the registry. To obtain the appropriate message string
from the message file, load the message file with the  <a href="http://msdn.microsoft.com/library/en-us/dllproc/base/loadlibrary.asp"><b>LoadLibrary</b></a> function and use the 
<a href="http://msdn.microsoft.com/library/en-us/debug/base/formatmessage.asp"><b>FormatMessage</b></a> function.</p>
<p>The binary information is information that is specific to the event. It
could be the contents of the processor registers when a device driver got
an error, a dump of an invalid packet that was received from the network,
a dump of all the structures in a program (when the data area was detected
to be corrupt), and so on. This information should be useful to the writer
of the device driver or the application in tracking down bugs or unauthorized
breaks into the application.</p>
<h4><a href="http://msdn.microsoft.com/library/en-us/sdkintro/sdkintro/requirements.asp">Requirements</a></h4><p><b>Windows NT/2000/XP: </b>Included in Windows NT 3.1 and later.<br><b>Windows 95/98/Me: </b>Unsupported.<br><b>Header: </b>Declared in Winnt.h; include Windows.h.<br></p>
<h4>See Also</h4>
<p><a href="http://msdn.microsoft.com/library/en-us/debug/base/event_logging.asp">Event Logging Overview</a>, <a href="http://msdn.microsoft.com/library/en-us/debug/base/event_logging_structures.asp">Event Logging Structures</a>, <a href="http://msdn.microsoft.com/library/en-us/security/security/lookupaccountsid.asp"><b>LookupAccountSid</b></a>, <a href="http://msdn.microsoft.com/library/en-us/debug/base/readeventlog.asp"><b>ReadEventLog</b></a></p>
<!-- Info Task Footer -->
<div class="itfBorder"><img src="eventlogrecord_str.asp_files/tiny.gif" width="1" height="1"></div>
<div class="itf"><b>Platform SDK Release: <font color="#ddaa00">August 2002</font></b>
<table cellpadding="0" cellspacing="0"><tbody><tr valign="top">
<td width="13" class="itficon"><a href="mailto:sdkfdbk@microsoft.com?subject=TITLE:%20EVENTLOGRECORD;%20RELEASE:%20August%202002;%20URL:%20base/eventlogrecord_str.xml" title="Send feedback to the Platform SDK team at sdkfdbk@microsoft.com"><img src="eventlogrecord_str.asp_files/sendfdbk.gif" border="0" width="13" height="15"></a></td>
<td width="47%" class="itf">What did you think of this topic?<br>
<a href="mailto:sdkfdbk@microsoft.com?subject=TITLE:%20EVENTLOGRECORD;%20RELEASE:%20August%202002;%20URL:%20base/eventlogrecord_str.xml" title="Send feedback to the Platform SDK team at sdkfdbk@microsoft.com">Let us know</a>.</td>
<td width="16" class="itficon"><img src="eventlogrecord_str.asp_files/download.gif" border="0" width="16" height="16"></td>
<td class="itf">Order a Platform SDK CD Online<br>
(<a href="http://go.microsoft.com/fwlink/?LinkId=6040" target="_blank" title="Order a CD online.">U.S./Canada</a>)   (<a href="http://go.microsoft.com/fwlink/?LinkId=6041" target="_blank" title="Order a CD online.">International</a>)</td></tr></tbody></table></div>
<p> </p>


<!-- End Content -->

 </td> </tr> </tbody></table>
<table width="100%" height="50" id="idToolbar" cellpadding="0" cellspacing="0" border="0" bgcolor="#003399">
<tbody><tr>
<td bgcolor="#003399" height="20" valign="middle" nowrap="" id="idTBLocal" width="100%">
<font face="Verdana, Arial" size="2"><b>

		  <a style="text-decoration: none;" href="http://register.microsoft.com/contactus30/contactus.asp?domain=msdn" target="_top"><font color="#ffffff">Contact Us</font></a>

					  <font color="#ffffff">|</font>
				
		  <a style="text-decoration: none;" href="mailto:?subject=An%20article%20from%20MSDN&amp;body=Here%20is%20an%20interesting%20article%20from%20MSDN:%20%20msdn.microsoft.com/library/en-us/debug/base/eventlogrecord_str.asp" target="_top"><font color="#ffffff">E-Mail this Page</font></a>

					  <font color="#ffffff">|</font>
				
		  <a style="text-decoration: none;" href="http://msdn.microsoft.com/flash/" target="_top"><font color="#ffffff">MSDN Flash Newsletter</font></a>


</b></font>
</td>
</tr>
<tr>
<td bgcolor="#003399" height="20" valign="middle" nowrap="" id="idTBLocal" width="100%">
<font face="Verdana, Arial" size="2"><b>
  <font color="#ffffff">� 2002 Microsoft Corporation. All rights reserved.</font>  
  <a style="text-decoration: none;" href="http://msdn.microsoft.com/library/en-us/debug/base/%20/isapi/gomscom.asp?target=/info/cpyright.htm" target="_top"><font color="#ffffff">Terms of Use</font></a>    <a style="text-decoration: none;" href="http://msdn.microsoft.com/isapi/gomscom.asp?target=/info/privacy.htm" target="_top"><font color="#ffffff">Privacy Statement </font></a>    <a style="text-decoration: none;" href="http://msdn.microsoft.com/isapi/gomscom.asp?target=/enable/" target="_top"><font color="#ffffff">Accessibility </font></a>  </b></font>
</td>
</tr>
</tbody></table>
 </body></html>